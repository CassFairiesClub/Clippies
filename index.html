<!DOCTYPE html>
<html>
<head>
    <title>Clippies NFT Viewer</title>
    <link rel="icon" type="image/x-icon" href="icon2.png">
    <style>
        html,
        body {
            margin: 0 auto;
            padding: 0;
            border: 0;
            box-sizing: border-box;
            width: 100%;
            height:  100%;
            background: #000000;
            font-family: 'Courier New', monospace;
        }
        #container {
            color: #ffffff;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        #top {
            padding : 10px;
            width: 100%;
            box-sizing: border-box;
            color: #ffffff;
            display : flex;
            justify-content: center;
            align-items : center;
        }
        #middle {
            width: 100%;
            height: 100%;
            box-sizing: border-box;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        #top_grid {
            margin-top: 20px;
            margin-bottom: 20px;
            width: 80%;
            color: #ffffff;
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(1, 1fr);
            grid-gap: 8px;
        }
        #bottom_grid {
            margin-top: 20px;
            margin-bottom: 20px;
            width: 80%;
            color: #ffffff;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(1, 1fr);
            grid-gap: 8px;
        }
        #grid {
            width: 80%; 
            color: #ffffff;
            display: grid;
            grid-template-columns: repeat(13, 1fr);
            grid-template-rows: repeat(4, 1fr);
            grid-gap: 8px;
        }
        #grid2, #grid3 {
            width: 80%;
            color: #ffffff;
            display: grid;
            grid-template-columns: repeat(13, 1fr);
            grid-gap: 8px;
        }
        #spacer {
            grid-column-start: 1;
            grid-column-end: 14;
            grid-row-start: 5;
            grid-row-end: 6;
            height: 20px;
        }
        img {
            width: 100%;
            height: 100%;
            box-sizing: border-box;
            opacity: 0.3;
        }
        .container {
            position: relative;
            text-align: center;
            color: white;
        }
        .top-right {
            position: absolute;
            top: 5px;
            right: 5px;
        }
        #toptitle {
            font-size: xxx-large;
            display:  flex;
            justify-content: center;
            margin: 40px;
        }
        select, button, #address {
            font-family: 'Courier New', monospace;
        }
        #selectBG {
            grid-column-start: 3;
            grid-column-end: 4;
        }
        #selectColor {
            grid-column-start: 4;
            grid-column-end: 5;
        }
        #offerBG {
            grid-column-start: 2;
            grid-column-end: 3;
        }
        #offerColor {
            grid-column-start: 3;
            grid-column-end: 4;
        }
        #offerSuit {
            grid-column-start: 4;
            grid-column-end: 5;
        }
        
    </style>

</head>
<body style="width: 100%;">
    <div id="container">
        <div id="toptitle">ðŸ“Ž CLIPPIES DECK VIEWER ðŸ“Ž</div>
        <div style="display: flex; justify-content: center;">Gather your Clippies into a single xch address and check your Deck</div>
        <div style="display: flex; justify-content: center; margin-bottom: 20px;">Collect all 52 cards for a custom Clippy</div>
        
        <div id="top">
            <input type="text" style="width: 64ch; padding: 10px;" id="address" name="address" value="xch..."/>
            <button id="button1" style="padding: 10px;">Check</button>
        </div>
        <div style="display: flex; justify-content: center;color: grey; margin: 20px;">Filter your deck by body and/or background color traits</div>
        <div id="top_grid">
            <select name="selectBG" id="selectBG">
                <option value="">--Background--</option>
                <option value="Black">Black</option>
                <option value="Bordeaux">Bordeaux</option>
                <option value="Green">Green</option>
                <option value="Wall-Street">Wall-Street</option>
                <option value="Ocean">Ocean</option>
                <option value="Purple">Purple</option>
                <option value="Help">Help</option>
            </select>
            <select name="selectColor" id="selectColor">
                <option value="">--Body Color--</option>
                <option value="Ivory">Ivory</option>
                <option value="Gold">Gold</option>
                <option value="Jade">Jade</option>
                <option value="Amethyst">Amethyst</option>
                <option value="Pink">Pink</option>
                <option value="Aqua">Aqua</option>
                <option value="Steel">Steel</option>
            </select>
        </div>
        <div style="display: flex; justify-content: center; margin: 20px;; font-size: x-large;">My Deck</div>
        <div id="grid">
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Spade_2"><div class="top-right" id="s2"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Spade_3"><div class="top-right" id="s3"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Spade_4"><div class="top-right" id="s4"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Spade_5"><div class="top-right" id="s5"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Spade_6"><div class="top-right" id="s6"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Spade_7"><div class="top-right" id="s7"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Spade_8"><div class="top-right" id="s8"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Spade_9"><div class="top-right" id="s9"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Spade_10"><div class="top-right" id="s10"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Spade_Jack"><div class="top-right" id="sJack"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Spade_Queen"><div class="top-right" id="sQueen"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Spade_King"><div class="top-right" id="sKing"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Spade_Ace"><div class="top-right" id="sAce"></div></div>
            <!-- <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Spade_Joker"><div class="top-right" id="sJoker"></div></div> -->
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Club_2"><div class="top-right" id="c2"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Club_3"><div class="top-right" id="c3"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Club_4"><div class="top-right" id="c4"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Club_5"><div class="top-right" id="c5"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Club_6"><div class="top-right" id="c6"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Club_7"><div class="top-right" id="c7"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Club_8"><div class="top-right" id="c8"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Club_9"><div class="top-right" id="c9"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Club_10"><div class="top-right" id="c10"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Club_Jack"><div class="top-right" id="cJack"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Club_Queen"><div class="top-right" id="cQueen"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Club_King"><div class="top-right" id="cKing"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Club_Ace"><div class="top-right" id="cAce"></div></div>
            <!-- <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Club_Joker"><div class="top-right" id="cJoker"></div></div> -->
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Heart_2"><div class="top-right" id="h2"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Heart_3"><div class="top-right" id="h3"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Heart_4"><div class="top-right" id="h4"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Heart_5"><div class="top-right" id="h5"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Heart_6"><div class="top-right" id="h6"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Heart_7"><div class="top-right" id="h7"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Heart_8"><div class="top-right" id="h8"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Heart_9"><div class="top-right" id="h9"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Heart_10"><div class="top-right" id="h10"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Heart_Jack"><div class="top-right" id="hJack"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Heart_Queen"><div class="top-right" id="hQueen"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Heart_King"><div class="top-right" id="hKing"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Heart_Ace"><div class="top-right" id="hAce"></div></div>
            <!-- <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Heart_Joker"><div class="top-right" id="hJoker"></div></div> -->
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Diamond_2"><div class="top-right" id="d2"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Diamond_3"><div class="top-right" id="d3"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Diamond_4"><div class="top-right" id="d4"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Diamond_5"><div class="top-right" id="d5"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Diamond_6"><div class="top-right" id="d6"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Diamond_7"><div class="top-right" id="d7"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Diamond_8"><div class="top-right" id="d8"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Diamond_9"><div class="top-right" id="d9"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Diamond_10"><div class="top-right" id="d10"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Diamond_Jack"><div class="top-right" id="dJack"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Diamond_Queen"><div class="top-right" id="dQueen"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Diamond_King"><div class="top-right" id="dKing"></div></div>
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Diamond_Ace"><div class="top-right" id="dAce"></div></div>
            <!-- <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png" id="Diamond_Joker"><div class="top-right" id="dJoker"></div></div> -->
            <div id="spacer"></div>

        </div>
        <div style="display: flex; justify-content: center; margin: 20px;; font-size: x-large;">My Cards</div>
        <div id="grid2">
            <div class="container"><img src="https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png"></div>
            <div id="spacer"></div>
        </div>
        <div style="display: flex; justify-content: center; margin-top: 20px; font-size: x-large;">Dexie Offers</div>
        <div style="display: flex; justify-content: center;color: grey; margin-bottom: 20px;">Click any offer to open dexie.</div>
        <div id="bottom_grid">
            <select name="offerBG" id="offerBG">
                <option value="">--Background--</option>
                <option value="Black">Black</option>
                <option value="Bordeaux">Bordeaux</option>
                <option value="Green">Green</option>
                <option value="Wall-Street">Wall-Street</option>
                <option value="Ocean">Ocean</option>
                <option value="Purple">Purple</option>
                <option value="Help">Help</option>
            </select>
            <select name="offerColor" id="offerColor">
                <option value="">--Body Color--</option>
                <option value="Ivory">Ivory</option>
                <option value="Gold">Gold</option>
                <option value="Jade">Jade</option>
                <option value="Amethyst">Amethyst</option>
                <option value="Pink">Pink</option>
                <option value="Aqua">Aqua</option>
                <option value="Steel">Steel</option>
            </select>
            <select name="offerSuit" id="offerSuit">
                <option value="">--Suit--</option>
                <option value="Heart">Heart</option>
                <option value="Spade">Spade</option>
                <option value="Diamond">Diamond</option>
                <option value="Club">Club</option>
            </select>
        </div>
        <div id="grid3"></div>
        <div style="display: flex; justify-content: center;color: grey;">Cass 2025</div>
    </div>   
    <script>
        let clippies = [];
        let clippies_dexie = [];
        let offers = [];
        let unique_offers = [];

        let Diamond = { _2: 0, _3: 0, _4: 0, _5: 0, _6: 0, _7: 0, _8: 0, _9: 0, _10: 0, _Jack: 0, _Queen: 0, _King: 0, _Ace: 0, };
        let Spade = { _2: 0, _3: 0, _4: 0, _5: 0, _6: 0, _7: 0, _8: 0, _9: 0, _10: 0, _Jack: 0, _Queen: 0, _King: 0, _Ace: 0, };
        let Heart = { _2: 0, _3: 0, _4: 0, _5: 0, _6: 0, _7: 0, _8: 0, _9: 0, _10: 0, _Jack: 0, _Queen: 0, _King: 0, _Ace: 0, };
        let Club =  { _2: 0, _3: 0, _4: 0, _5: 0, _6: 0, _7: 0, _8: 0, _9: 0, _10: 0, _Jack: 0, _Queen: 0, _King: 0, _Ace: 0, };

    async function post(_request) {
        try {
            const response = await fetch(_request);
            const result = await response.json();
            return result;
        } catch (error) {
            console.error("Error:", error);
        }
    };
    async function checkaddress(_address) {
        console.log(_address);
        let nfts = [];
        const clippies_id = "col15487n4c9sm9jtv5svd0xt534dwrukrs94pd095r7hmxed3j2geesj5jxk5";
        let next = "";
        let items = 100;
        while (items == 100) {
            const get_nfts = new Request("https://api.mintgarden.io/address/" + _address + "/nfts?collection_id=" + clippies_id + "&type=owned&size=100&page=" + next);
            const json = await post(get_nfts);
            next = json.next;
            items = json.items.length;
            json.items.forEach((element) => nfts.push(element));
        }
            
        let actions = nfts.map((element) => getData(element.edition_number, "owned"));
        var results = Promise.all(actions);

        results.then(data => orderData(clippies, "owned"));
    };

    async function checkDexie() {
        
        let page = 1;
        let get_offers = new Request("https://api.dexie.space/v1/offers?offered=col15487n4c9sm9jtv5svd0xt534dwrukrs94pd095r7hmxed3j2geesj5jxk5&requested=XCH&status=0&sort=price&compact=false&page_size=100");
        let json = await post(get_offers);
        json.offers.forEach((element) => offers.push(element));

        let page_count = Math.floor(json.count/100)+1;

        while (page != page_count) {
            get_offers = new Request("https://api.dexie.space/v1/offers?offered=col15487n4c9sm9jtv5svd0xt534dwrukrs94pd095r7hmxed3j2geesj5jxk5&requested=XCH&status=0&sort=price&compact=false&page_size=100&page=" + (page+1));
            json = await post(get_offers);
            json.offers.forEach((element) => offers.push(element));
            page++;
        }
        
        for (const element of offers) {
            if (element.offered[0].name == "Gene") {
                element.offered[0].name = "#Gene"
            }
            if (element.offered[0].name == "Trent") {
                element.offered[0].name = "#Trent"
            }
        };
        
        console.log(offers);        


        let actions = offers.map((element) => getData(element.offered[0].name.split("#")[1], "offers"));
        var results = Promise.all(actions);
        results.then(data => orderData(clippies_dexie, "offers"));
    };        

checkDexie();

    const myButton = document.getElementById('button1');
    myButton.addEventListener("click", (event) => {
        clippies = [];
        reinitcount();

        const myNode = document.getElementById("grid2");
        myNode.innerHTML = '';

        const clearnumbers = document.getElementById("grid").getElementsByClassName("top-right");
        for (const element of clearnumbers) { element.innerHTML = ''; };
        let images = document.getElementById("grid2").getElementsByClassName("container");
        for (image of images) {
            image.src = "https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png";
            image.style.opacity = 0.3;
            image.style.border = "none";
        }
        const myaddy = document.getElementById('address').value;
        checkaddress(myaddy);
    });

    function drawDeck() {
        // clear Deck
        const clearnumbers = document.getElementById("grid").getElementsByClassName("top-right");

        const clippies_off = clippies.filter(elem => elem.visibility === "off");
        for (const element of clippies_off) { 
            for (const element of clearnumbers) { element.style.opacity = 0; };
            document.getElementById(element.suit + "_" + element.card).src = "https://ipfs.io/ipfs/QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR/9987.png";
            document.getElementById(element.suit + "_" + element.card).style.opacity = 0.3;
            document.getElementById(element.suit + "_" + element.card).style.border = "none";
        };
        const clippies_on = clippies.filter(elem => elem.visibility === "on");
        for (const element of clippies_on) { 
            document.getElementById(element.suit + "_" + element.card).src = element.png;
            document.getElementById(element.suit + "_" + element.card).style.opacity = 1;
            document.getElementById(element.suit + "_" + element.card).style.border = "1px solid #444444";
            document.getElementById(element.suit + "_" + element.card).style.borderRadius = "3px";
            for (const element of clearnumbers) { element.style.opacity = 1; };
            reinitcount();
            numberData(element);
        };
        
    };
    function drawOffer() {
        // clear Offers
        const clippies_on = clippies_dexie.filter(elem => elem.visibility === "on");
        const myNode = document.getElementById("grid3");
        myNode.innerHTML = '';
        


        for (const element of clippies_on) { 

            
            var mydiv = document.createElement("div");
            mydiv.className = "container";
            document.getElementById("grid3").appendChild(mydiv);

            var elem = document.createElement("img");
            elem.src = element.png;
            elem.style.opacity = 1;
            elem.style.borderRadius = "3px";
            elem.id = element.id;
            elem.addEventListener("click", function (e) {
                console.log(element.id);
                let url = "https://dexie.space/offers/" + element.id;
                window.open(url, '_blank').focus();
            });
            mydiv.appendChild(elem);

            var elem = document.createElement("div");
            elem.className = "top-right";
            elem.innerHTML = element.price;
            elem.id = "price_" + element.id;
            mydiv.appendChild(elem);
            
        };
        
    };

    const filterBG = document.getElementById('selectBG');
    filterBG.addEventListener("change", (event) => {
        for (const element of clippies) {
                element.visibility = "off"
            };
        if (filterBG.value && filterColor.value) {
            const filtered = clippies.filter(elem => elem.background === filterBG.value && elem.color === filterColor.value);
            for (const element of filtered) {
                element.visibility = "on"
            };    
        } else if (filterBG.value && !filterColor.value) {
            const filtered = clippies.filter(elem => elem.background === filterBG.value);
            for (const element of filtered) {
                element.visibility = "on"
            };
        } else if (!filterBG.value && filterColor.value) {
            const filtered = clippies.filter(elem => elem.color === filterColor.value);
            for (const element of filtered) {
                element.visibility = "on"
            };
        } else {
            for (const element of clippies) {
                element.visibility = "on"
            };
            
        }
        drawDeck()
        
    });

    const filterColor = document.getElementById('selectColor');
    filterColor.addEventListener("change", (event) => {
        for (const element of clippies) {
                element.visibility = "off"
            };
        if (filterBG.value && filterColor.value) {
            const filtered = clippies.filter(elem => elem.background === filterBG.value && elem.color === filterColor.value);
            for (const element of filtered) {
                element.visibility = "on"
            };    
        } else if (filterBG.value && !filterColor.value) {
            const filtered = clippies.filter(elem => elem.background === filterBG.value);
            for (const element of filtered) {
                element.visibility = "on"
            };
        } else if (!filterBG.value && filterColor.value) {
            const filtered = clippies.filter(elem => elem.color === filterColor.value);
            for (const element of filtered) {
                element.visibility = "on"
            };
        } else {
            for (const element of clippies) {
                element.visibility = "on"
            };
            
        }
        drawDeck()
    });

    const offerColor = document.getElementById('offerColor');
    offerColor.addEventListener("change", (event) => {
        for (const element of clippies_dexie) {
                element.visibility = "off"
            };
        if (offerColor.value) {
            offerBG.disabled = true;
            offerSuit.disabled = true;
            const filtered = clippies_dexie.filter(elem => elem.color === offerColor.value);
            for (const element of filtered) {
                element.visibility = "on"
            };    
        } else {
            offerBG.disabled = false;
            offerSuit.disabled = false;
            for (const element of clippies_dexie) {
                element.visibility = "on"
            };
        }
        drawOffer()
    });
    const offerBG = document.getElementById('offerBG');
    offerBG.addEventListener("change", (event) => {
        for (const element of clippies_dexie) {
                element.visibility = "off"
            };
        if (offerBG.value) {
            offerColor.disabled = true;
            offerSuit.disabled = true;
            const filtered = clippies_dexie.filter(elem => elem.background === offerBG.value);
            for (const element of filtered) {
                element.visibility = "on"
            };    
        } else {
            offerColor.disabled = false;
            offerSuit.disabled = false;
            for (const element of clippies_dexie) {
                element.visibility = "on"
            };
        }
        drawOffer()
    });
    const offerSuit = document.getElementById('offerSuit');
    offerSuit.addEventListener("change", (event) => {
        for (const element of clippies_dexie) {
                element.visibility = "off"
            };
        if (offerSuit.value) {
            offerBG.disabled = true;
            offerColor.disabled = true;
            const filtered = clippies_dexie.filter(elem => elem.suit === offerSuit.value);
            for (const element of filtered) {
                element.visibility = "on"
            };    
        } else {
            offerBG.disabled = false;
            offerColor.disabled = false;
            for (const element of clippies_dexie) {
                element.visibility = "on"
            };
        }
        drawOffer()
    });




function orderData(clippies, type) {
    if (type == "owned") {
        clippies.sort((a, b) => a.background.localeCompare(b.background) || a.card.localeCompare(b.card) || a.color.localeCompare(b.color) || a.suit.localeCompare(b.suit));
        console.log(clippies);
    } else {
        clippies.sort((a, b) => a.card.localeCompare(b.card)) || a.background.localeCompare(b.background) || a.price.toString().localeCompare(b.price.toString()) || a.color.localeCompare(b.color) || a.suit.localeCompare(b.suit);
        console.log(clippies_dexie);      
    }
    
    for (const element of clippies) {
        
        if (type == "owned") {
            var elem = document.createElement("img");
            elem.src = element.png;
            elem.style.opacity = 1;
            elem.style.borderRadius = "3px";
            elem.className = "container";
            document.getElementById("grid2").appendChild(elem);
        
            document.getElementById(element.suit + "_" + element.card).src = element.png;
            document.getElementById(element.suit + "_" + element.card).style.opacity = 1;
            document.getElementById(element.suit + "_" + element.card).style.border = "1px solid #444444";
            document.getElementById(element.suit + "_" + element.card).style.borderRadius = "3px";

            numberData(element);
            
        } else {
            var mydiv = document.createElement("div");
            mydiv.className = "container";
            document.getElementById("grid3").appendChild(mydiv);

            var elem = document.createElement("img");
            elem.src = element.png;
            elem.style.opacity = 1;
            elem.style.borderRadius = "3px";
            elem.id = element.id;
            elem.addEventListener("click", function (e) {
                console.log(element.id);
                let url = "https://dexie.space/offers/" + element.id;
                window.open(url, '_blank').focus();
            });
            mydiv.appendChild(elem);

            var elem = document.createElement("div");
            elem.className = "top-right";
            elem.innerHTML = element.price;
            elem.id = "price_" + element.id;
            mydiv.appendChild(elem);


        }
    }

};

function reinitcount() {     
    Diamond = { _2: 0, _3: 0, _4: 0, _5: 0, _6: 0, _7: 0, _8: 0, _9: 0, _10: 0, _Jack: 0, _Queen: 0, _King: 0, _Ace: 0, };
    Spade = { _2: 0, _3: 0, _4: 0, _5: 0, _6: 0, _7: 0, _8: 0, _9: 0, _10: 0, _Jack: 0, _Queen: 0, _King: 0, _Ace: 0, };
    Heart = { _2: 0, _3: 0, _4: 0, _5: 0, _6: 0, _7: 0, _8: 0, _9: 0, _10: 0, _Jack: 0, _Queen: 0, _King: 0, _Ace: 0, };
    Club =  { _2: 0, _3: 0, _4: 0, _5: 0, _6: 0, _7: 0, _8: 0, _9: 0, _10: 0, _Jack: 0, _Queen: 0, _King: 0, _Ace: 0, };
};

function numberData(element) {     

            switch (element.card) {
                case '2':
                switch (element.suit) {
                    case 'Spade':
                    Spade._2 += 1; if (Spade._2 >= 2) { document.getElementById("s" + element.card).innerHTML = "x" + Spade._2; };  break;
                    case 'Heart':
                    Heart._2 += 1; if (Heart._2 >= 2) { document.getElementById("h" + element.card).innerHTML = "x" + Heart._2; };  break;
                    case 'Diamond':
                    Diamond._2 += 1; if (Diamond._2 >= 2) { document.getElementById("d" + element.card).innerHTML = "x" + Diamond._2; }; break;
                    case 'Club':
                    Club._2 += 1;  if (Club._2 >= 2) {  document.getElementById("c" + element.card).innerHTML = "x" + Club._2;  };  break;
                };break;
            }
            switch (element.card) {
                case '3':
                switch (element.suit) {
                    case 'Spade':
                    Spade._3 += 1; if (Spade._3 >= 2) { document.getElementById("s" + element.card).innerHTML = "x" + Spade._3; };  break;
                    case 'Heart':
                    Heart._3 += 1; if (Heart._3 >= 2) { document.getElementById("h" + element.card).innerHTML = "x" + Heart._3; };  break;
                    case 'Diamond':
                    Diamond._3 += 1; if (Diamond._3 >= 2) { document.getElementById("d" + element.card).innerHTML = "x" + Diamond._3; }; break;
                    case 'Club':
                    Club._3 += 1;  if (Club._3 >= 2) {  document.getElementById("c" + element.card).innerHTML = "x" + Club._3;  };  break;
                };break;
            }
            switch (element.card) {
                case '4':
                switch (element.suit) {
                    case 'Spade':
                    Spade._4 += 1; if (Spade._4 >= 2) { document.getElementById("s" + element.card).innerHTML = "x" + Spade._4; };  break;
                    case 'Heart':
                    Heart._4 += 1; if (Heart._4 >= 2) { document.getElementById("h" + element.card).innerHTML = "x" + Heart._4; };  break;
                    case 'Diamond':
                    Diamond._4 += 1; if (Diamond._4 >= 2) { document.getElementById("d" + element.card).innerHTML = "x" + Diamond._4; }; break;
                    case 'Club':
                    Club._4 += 1;  if (Club._4 >= 2) {  document.getElementById("c" + element.card).innerHTML = "x" + Club._4;  };  break;
                };break;
            }
            switch (element.card) {
                case '5':
                switch (element.suit) {
                    case 'Spade':
                    Spade._5 += 1; if (Spade._5 >= 2) { document.getElementById("s" + element.card).innerHTML = "x" + Spade._5; };  break;
                    case 'Heart':
                    Heart._5 += 1; if (Heart._5 >= 2) { document.getElementById("h" + element.card).innerHTML = "x" + Heart._5; };  break;
                    case 'Diamond':
                    Diamond._5 += 1; if (Diamond._5 >= 2) { document.getElementById("d" + element.card).innerHTML = "x" + Diamond._5; }; break;
                    case 'Club':
                    Club._5 += 1;  if (Club._5 >= 2) {  document.getElementById("c" + element.card).innerHTML = "x" + Club._5;  };  break;
                };break;
            }
            switch (element.card) {
                case '6':
                switch (element.suit) {
                    case 'Spade':
                    Spade._6 += 1; if (Spade._6 >= 2) { document.getElementById("s" + element.card).innerHTML = "x" + Spade._6; };  break;
                    case 'Heart':
                    Heart._6 += 1; if (Heart._6 >= 2) { document.getElementById("h" + element.card).innerHTML = "x" + Heart._6; };  break;
                    case 'Diamond':
                    Diamond._6 += 1; if (Diamond._6 >= 2) { document.getElementById("d" + element.card).innerHTML = "x" + Diamond._6; }; break;
                    case 'Club':
                    Club._6 += 1;  if (Club._6 >= 2) {  document.getElementById("c" + element.card).innerHTML = "x" + Club._6;  };  break;
                };break;
            }
            switch (element.card) {
                case '7':
                switch (element.suit) {
                    case 'Spade':
                    Spade._7 += 1; if (Spade._7 >= 2) { document.getElementById("s" + element.card).innerHTML = "x" + Spade._7; };  break;
                    case 'Heart':
                    Heart._7 += 1; if (Heart._7 >= 2) { document.getElementById("h" + element.card).innerHTML = "x" + Heart._7; };  break;
                    case 'Diamond':
                    Diamond._7 += 1; if (Diamond._7 >= 2) { document.getElementById("d" + element.card).innerHTML = "x" + Diamond._7; }; break;
                    case 'Club':
                    Club._7 += 1;  if (Club._7 >= 2) {  document.getElementById("c" + element.card).innerHTML = "x" + Club._7;  };  break;
                };break;
            }
            switch (element.card) {
                case '8':
                switch (element.suit) {
                    case 'Spade':
                    Spade._8 += 1; if (Spade._8 >= 2) { document.getElementById("s" + element.card).innerHTML = "x" + Spade._8; };  break;
                    case 'Heart':
                    Heart._8 += 1; if (Heart._8 >= 2) { document.getElementById("h" + element.card).innerHTML = "x" + Heart._8; };  break;
                    case 'Diamond':
                    Diamond._8 += 1; if (Diamond._8 >= 2) { document.getElementById("d" + element.card).innerHTML = "x" + Diamond._8; }; break;
                    case 'Club':
                    Club._8 += 1;  if (Club._8 >= 2) {  document.getElementById("c" + element.card).innerHTML = "x" + Club._8;  };  break;
                };break;
            }
            switch (element.card) {
                case '9':
                switch (element.suit) {
                    case 'Spade':
                    Spade._9 += 1; if (Spade._9 >= 2) { document.getElementById("s" + element.card).innerHTML = "x" + Spade._9; };  break;
                    case 'Heart':
                    Heart._9 += 1; if (Heart._9 >= 2) { document.getElementById("h" + element.card).innerHTML = "x" + Heart._9; };  break;
                    case 'Diamond':
                    Diamond._9 += 1; if (Diamond._9 >= 2) { document.getElementById("d" + element.card).innerHTML = "x" + Diamond._9; }; break;
                    case 'Club':
                    Club._9 += 1;  if (Club._9 >= 2) {  document.getElementById("c" + element.card).innerHTML = "x" + Club._9;  };  break;
                };break;
            }
            switch (element.card) {
                case '10':
                switch (element.suit) {
                    case 'Spade':
                    Spade._10 += 1; if (Spade._10 >= 2) { document.getElementById("s" + element.card).innerHTML = "x" + Spade._10; };  break;
                    case 'Heart':
                    Heart._10 += 1; if (Heart._10 >= 2) { document.getElementById("h" + element.card).innerHTML = "x" + Heart._10; };  break;
                    case 'Diamond':
                    Diamond._10 += 1; if (Diamond._10 >= 2) { document.getElementById("d" + element.card).innerHTML = "x" + Diamond._10; }; break;
                    case 'Club':
                    Club._10 += 1;  if (Club._10 >= 2) {  document.getElementById("c" + element.card).innerHTML = "x" + Club._10;  };  break;
                };break;
            }
            switch (element.card) {
                case 'Jack':
                switch (element.suit) {
                    case 'Spade':
                    Spade._Jack += 1; if (Spade._Jack >= 2) { document.getElementById("s" + element.card).innerHTML = "x" + Spade._Jack; };  break;
                    case 'Heart':
                    Heart._Jack += 1; if (Heart._Jack >= 2) { document.getElementById("h" + element.card).innerHTML = "x" + Heart._Jack; };  break;
                    case 'Diamond':
                    Diamond._Jack += 1; if (Diamond._Jack >= 2) { document.getElementById("d" + element.card).innerHTML = "x" + Diamond._Jack; }; break;
                    case 'Club':
                    Club._Jack += 1;  if (Club._Jack >= 2) {  document.getElementById("c" + element.card).innerHTML = "x" + Club._Jack;  };  break;
                };break;
            }
            switch (element.card) {
                case 'Queen':
                switch (element.suit) {
                    case 'Spade':
                    Spade._Queen += 1; if (Spade._Queen >= 2) { document.getElementById("s" + element.card).innerHTML = "x" + Spade._Queen; };  break;
                    case 'Heart':
                    Heart._Queen += 1; if (Heart._Queen >= 2) { document.getElementById("h" + element.card).innerHTML = "x" + Heart._Queen; };  break;
                    case 'Diamond':
                    Diamond._Queen += 1; if (Diamond._Queen >= 2) { document.getElementById("d" + element.card).innerHTML = "x" + Diamond._Queen; }; break;
                    case 'Club':
                    Club._Queen += 1;  if (Club._Queen >= 2) {  document.getElementById("c" + element.card).innerHTML = "x" + Club._Queen;  };  break;
                };break;
            }
            switch (element.card) {
                case 'King':
                switch (element.suit) {
                    case 'Spade':
                    Spade._King += 1; if (Spade._King >= 2) { document.getElementById("s" + element.card).innerHTML = "x" + Spade._King; };  break;
                    case 'Heart':
                    Heart._King += 1; if (Heart._King >= 2) { document.getElementById("h" + element.card).innerHTML = "x" + Heart._King; };  break;
                    case 'Diamond':
                    Diamond._King += 1; if (Diamond._King >= 2) { document.getElementById("d" + element.card).innerHTML = "x" + Diamond._King; }; break;
                    case 'Club':
                    Club._King += 1;  if (Club._King >= 2) {  document.getElementById("c" + element.card).innerHTML = "x" + Club._King;  };  break;
                };break;
            }
            switch (element.card) {
                case 'Ace':
                switch (element.suit) {
                    case 'Spade':
                    Spade._Ace += 1; if (Spade._Ace >= 2) { document.getElementById("s" + element.card).innerHTML = "x" + Spade._Ace; };  break;
                    case 'Heart':
                    Heart._Ace += 1; if (Heart._Ace >= 2) { document.getElementById("h" + element.card).innerHTML = "x" + Heart._Ace; };  break;
                    case 'Diamond':
                    Diamond._Ace += 1; if (Diamond._Ace >= 2) { document.getElementById("d" + element.card).innerHTML = "x" + Diamond._Ace; }; break;
                    case 'Club':
                    Club._Ace += 1;  if (Club._Ace >= 2) {  document.getElementById("c" + element.card).innerHTML = "x" + Club._Ace;  };  break;
                };break;
            }
            switch (element.card) {
                case 'Joker':
                switch (element.suit) {
                    case 'Spade':
                    Spade._Joker += 1; if (Spade._Joker >= 2) { document.getElementById("s" + element.card).innerHTML = "x" + Spade._Joker; };  break;
                    case 'Heart':
                    Heart._Joker += 1; if (Heart._Joker >= 2) { document.getElementById("h" + element.card).innerHTML = "x" + Heart._Joker; };  break;
                    case 'Diamond':
                    Diamond._Joker += 1; if (Diamond._Joker >= 2) { document.getElementById("d" + element.card).innerHTML = "x" + Diamond._Joker; }; break;
                    case 'Club':
                    Club._Joker += 1;  if (Club._Joker >= 2) {  document.getElementById("c" + element.card).innerHTML = "x" + Club._Joker;  };  break;
                };break;
            }
};

async function getData(clippy, type) {
    let ipfs;

    if (clippy == "Gene" || clippy == "Trent") {
        return;
        // ipfs = "QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR";
    } else if (clippy <= 500) {
        ipfs = "QmTsrrZj7xXv77bqTJYiTVjMKbdouHzucvYNWBcXPAC84e";
    } else if (clippy >= 501 && clippy <= 1000) {
        ipfs = "QmYcwcqx6RK3WfciaHHwF4ufZRLGAVEyJs4vGJs1gHMj33";
    } else if (clippy >= 1001 && clippy <= 1500) {
        ipfs = "QmYUa85FNnwTEzf8pmk7MikQQiuP7yBpeN5uur746KbiX5";
    } else if (clippy >= 1501 && clippy <= 2000) {
        ipfs = "QmVycZrB5SqL3xk6kcGfpmnxwqVmZKSXjn6sNr5rZyLHeo";
    } else if (clippy >= 2001 && clippy <= 2500) {
        ipfs = "QmamyMK13SNrJwyWEhVQAPP6RRQpj2U2LFw8wHdRqsXzeM";
    } else if (clippy >= 2501 && clippy <= 3000) {
        ipfs = "QmU4F95awtbGGqoAEdnM3Tn4N22jbJpuoW7HCD9LJBvXih";
    } else if (clippy >= 3001 && clippy <= 3500) {
        ipfs = "QmcNRmxkC5fpnfzEQYNGk69niHrWywcgrBnuUGVNncfmJS";
    } else if (clippy >= 3501 && clippy <= 4000) {
        ipfs = "QmfZAdabihjv5iKZuU6xNoJCywyoEJq7bcvRtrBZcxc2Dw";
    } else if (clippy >= 4001 && clippy <= 4500) {
        ipfs = "QmRbXRYuyWWnAGGBrYZnep8XStAEqQ9o15LoWKwz7Efkob";
    } else if (clippy >= 4501 && clippy <= 5000) {
        ipfs = "QmPbA26u7FwsctdvQgaR8HBvT1jUQi7BEe7778ksh69TVk";
    } else if (clippy >= 5001 && clippy <= 5500) {
        ipfs = "Qmeqj9qwuLH5bxqJFHtA4Ej6etZt1aM3bnKoqnaCxzvnDN";
    } else if (clippy >= 5501 && clippy <= 6000) {
        ipfs = "QmR2Bptoy7vsp9UmvowZz2yzWMqVMP7hKxrzfsafg87PEy";
    } else if (clippy >= 6001 && clippy <= 6500) {
        ipfs = "QmVmE6exxhckoTfgefyVo9MzbpVDzuop4s6wox7iAorq8y";
    } else if (clippy >= 6501 && clippy <= 7000) {
        ipfs = "QmXRopcpWf8XfZZiXkDtdg3Vz5ggghqxqDGfbzJH9fCs6d";
    } else if (clippy >= 7001 && clippy <= 7500) {
        ipfs = "QmTGqCRCPWcp8FQvKi9nCs2peC2YtmieNp1w81AxrpcYyh";
    } else if (clippy >= 7501 && clippy <= 8000) {
        ipfs = "QmUE3Tz9U9jJxbTiD8iWMhQEbzQqgLpepNt7uyYfMARXcf";
    } else if (clippy >= 8001 && clippy <= 8500) {
        ipfs = "QmcFzJpbRqKxrbPMWfYUbGCxB9W5MWYV18gZBriYpMFAhJ";
    } else if (clippy >= 8501 && clippy <= 9000) {
        ipfs = "QmbyQoTgTWsACphuz7heubo1nGDozvQ2vXCSA71JKxjuwN";
    } else if (clippy >= 9001 && clippy <= 9500) {
        ipfs = "QmdxnVeBEv9avVYvjB1DUxRCYZ4F3eD5fuTgSfVmPRgAuD";
    } else if (clippy >= 9501 && clippy <= 10000) {
        ipfs = "QmbW7u4Poo5uWssZygsKSho1f1gHE3Hn3AxtdwxsWM2PQR";
    }

    const url = "https://ipfs.io/ipfs/" + ipfs + "/" + clippy + ".json";
    const png = "https://ipfs.io/ipfs/" + ipfs + "/" + clippy + ".png";

    try {
        const response = await fetch(url);
        if (!response.ok) {
          throw new Error(`Response status: ${response.status}`);
      }

      const result = await response.text();
      const attributes = result.search(/Background/g);
      const sliced = result.slice(attributes);
      const values = sliced.split("\"");
      const Background = values[4];
      const Body = values[12];
      const Eyes = values[20];
      const Eyebrows = values[28];
      const Card = values[36];
      const Color = values[44];
      const Suit = values[52];

      if ( Suit != "Joker") {
        let current_clippy = {
            number: clippy,
            background: Background,
            body: Body,
            color: Color,
            suit: Suit,
            card: Card,
            eyes: Eyes,
            eyebrows: Eyebrows,
            url: url,
            png: png,
            price: 0,
            offer_id: "",
            visibility: "off",
            
        }
        if (type == "owned") {
            clippies.push(current_clippy);
        } else {
            
            let check_clippy = clippies_dexie.find((elem) => elem.number == current_clippy.number);
            if (!check_clippy) {
                let myclip = offers.find((elem) => elem.offered[0].name == "Clippy #" + clippy);
                current_clippy.price = Math.round( myclip.price * 1000) / 1000;
                current_clippy.id = myclip.id;
                clippies_dexie.push(current_clippy);
            }
        }
    }
} catch (error) {
    console.error(error.message);
}
}

</script>
</body>
</html>
